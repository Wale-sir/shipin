<!DOCTYPE html>
{% load static %}
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}{% endblock %}</title>
    {% block css %}
        <style>
        .head{
            background-color: #FF79A3;
            height: 100px;
            position:relative;
        }
        .body{
            background-color: aqua;

        }
        .foot{
            background-color: antiquewhite;

        }
        .box{
        width:50%; margin-top:100%; margin:auto; padding:28px;
        height:350px; border:1px #111 solid;
        display:none;            /* 默认对话框隐藏 */
    }
    .box.show{display:block;position:relative;}
    .box .box_x{ font-size:18px; text-align:right; display:block;position:relative;}
    .box input{width:80%; font-size:18px; margin-top:18px;position:relative;background-color: #fff}

        </style>
    <script src="/static/js/jquery.min.js" type="text/javascript"></script>
    <script src="/static/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>
    {% endblock %}
</head>
<body>
<div class="head">
<h1>
    head

</h1>
<div>
    {% if user %}
            {% if  type != 'home'%}
                <a href="{% url 'user' %}">个人主页</a>
                {% else %}
                <a href="{% url 'home' %}">首页</a>
            {% endif %}
            <a href="{% url 'logout' %}">退出</a>
    {% else%}

        <input class="box_x" type="button" onClick="re_box(2);login_box(0); return false;" value="点击注册">
        <input class="box_x" type="button" onClick="login_box(1);re_box(0); return false;" value="点击登陆">


{#        注册#}
        <div id='input_re_box' class="box" style="background:#66ccff; color:#000">
            <a class='box_x' onclick="re_box(0); return false;">关闭</a> {#点击事件#}
                <h1>用户注册</h1>
                <label for="id_username">用户名:</label>
                <input type="text" id="id_username" name="username" placeholder="用户名">
                <br>
                <label for="id_password">密&nbsp;&nbsp;&nbsp;&nbsp;码:</label>
                <input type="password" id="id_password" name="password" placeholder="密码">
                <br>
                <label for="id_password">重复密码:</label>
                <input type="password" id="id_check_password" name="check_password" placeholder="重复密码">
                <button id="js_push_re" type="submit">提交</button>

{#            点击 显示登录 关闭注册#}
            <a class="box_x" onClick="login_box(1);re_box(0);return false; ">点击登录</a>
            {#            点击之后 显示邮箱登录 关闭 用户名注册#}
            <a class="box_x" onClick="re_email_box(3);re_box(0); return false;" >邮箱注册</a>
            {{ error }}
        </div>

{#        登录#}
        <div id='input_login_box' class="box" style="background:#66ccff; color:#000">
            <a class='box_x' onclick="login_box(0); return false;">关闭</a>  {#点击事件#}
                <h1>用户登录</h1>
                    <label for="id_username">用户名:</label>
                    <input type="text" name="username" id="id_login_username" placeholder="用户名\邮箱"><br>
                    <label for="id_password">密&nbsp;&nbsp;&nbsp;&nbsp;码:</label>
                    <input type="password" name="password" id="id_login_password" placeholder="密码"><br><br><br>
                <button id="js_push_login"  type="submit">提交</button>
{#            点击 显示登录#}
            <a class="box_x" onClick="re_box(2);login_box(0);return false;">点击注册</a>
                 {{ error }}
        </div>

{#        邮箱验证登录 #}
        <div id='input_email_box' class="box" style="background:#66ccff; color:#000">
            <a class='box_x' onclick="re_email_box(0); return false;">关闭</a>  {#点击事件#}
                <h1>邮箱注册</h1>
                    <label for="id_username">邮&nbsp;&nbsp;&nbsp;&nbsp;箱:</label>
                    <input type="text" name="email" id="id_email" placeholder="邮箱"><br>
                    <label for="id_password">密&nbsp;&nbsp;&nbsp;&nbsp;码:</label>
                    <input type="password" name="password" id="id_email_password" placeholder="密码"><br>
                    <label for="id_password">重复密码:</label>
                    <input type="password" name="id_check_password" id="id_email_check_password" placeholder="重复密码">
                    <button id="js_push_email"  type="submit">提交</button>
            <a class='box_x' onclick="re_box(2);re_email_box(0);return false; ">用户名注册</a>
            {{ error }}
        </div>
    {% endif %}


    {%  if username %}
            user:{{ username }}
    {%  endif %}
    </div>
</div>


<div class="body" style="height:auto;">
    <h1>
        body
    </h1>
    <div class="videos-label">
        {% block custom_bread %}
        {% endblock %}
        {% block content %}
        {% endblock %}
    </div>
</div>
</body>

<footer>
<div class="foot">
        <h1>
       foot
    </h1>
</div>
{% block custom_jss %}
{% endblock %}
    <script type="text/javascript">
        {# 登录 #}
        function login_box(n){
            document.getElementById('input_login_box').style.display=n?'block':'none';     /* 点击按钮打开/关闭 对话框 */
        }
        {# 注册 #}
        function re_box(n){
            document.getElementById('input_re_box').style.display=n?'block':'none';     /* 点击按钮打开/关闭 对话框 */
        }

        {# 邮箱注册 #}
        function re_email_box(n) {
            document.getElementById('input_email_box').style.display=n?'block':'none';
        }
        {# 登录验证 #}
        $(document).ready(function() {
            $('#js_push_login').on('click',
                function () {
                var username = $('#id_login_username').val();
                var password = $('#id_login_password').val();
                $.ajax({
                    cache:false,
                    type:'POST',
                    url:'{% url 'login' %}',
                    data:{
                        'username': username,
                        'password': password},
                    async:true,
                    beforeSend:function (xhr,setting) {
                        xhr.setRequestHeader('X-CSRFToken','{{ csrf_token }}');
                    },
                    success:function (data) {
                    if (data.status == 'fail'){
                            alert(data.msg)
                    }else if(data.status == 'success'){
                            alert(data.msg);
                        window.location.reload();
                    }}
                        })
                    }
                )
            }
        );

        {# 注册验证登录 #}
        $(document).ready(function() {
            $('#js_push_re').on('click',
                function () {
                var username = $('#id_username').val();
                var password = $('#id_password').val();
                var check_password = $('#id_check_password').val();
                $.ajax({
                    cache:false,
                    type:'POST',
                    url:'{% url 're' %}',
                    data:{
                        'username': username,
                        'password': password,
                        'check_password': check_password},
                    async:true,
                    beforeSend:function (xhr,setting) {
                        xhr.setRequestHeader('X-CSRFToken','{{ csrf_token }}');
                    },
                    success:function (data) {
                    if (data.status == 'fail'){
                            alert(data.msg)
                    }else if(data.status == 'success'){
                            alert(data.msg);
                        window.location.reload();
                    }}
                        })
                    }
                )
            }
        );

        {# 邮箱注册登录 #}
        $(document).ready(function() {
            $('#js_push_email').on('click',
                function () {
                var email = $('#id_email').val();
                var password = $('#id_email_password').val();
                var check_password = $('#id_email_check_password').val();
                $.ajax({
                    cache:false,
                    type:'POST',
                    url:'{% url 're_email' %}',
                    data:{
                        'email': email,
                        'password': password,
                        'check_password': check_password},
                    async:true,
                    beforeSend:function (xhr,setting) {
                        xhr.setRequestHeader('X-CSRFToken','{{ csrf_token }}');
                    },
                    success:function (data) {
                    if (data.status == 'fail'){
                            alert(data.msg)
                    }else if(data.status == 'success'){
                            alert(data.msg);
                        window.location.reload();
                    }}
                        })
                    }
                )
            }
        )

     </script>
</footer>
<script src="/static/js/selectUi.js" type="text/javascript"></script>
<script src="/static/js/deco-common.js" type="text/javascript"></script>
<script src="/static/js/plugins/unslider.js" type="text/javascript"></script>
<script src="/static/js/plugins/laydate/laydate.js" type="text/javascript"></script>
<script src="/static/js/plugins/layer/layer.js" type="text/javascript"></script>
<script src="/static/js/plugins/queryCity/js/public.js" type="text/javascript"></script>
<script src="/static/js/plugins/jquery.scrollLoading.js" type="text/javascript"></script>
</html>